# ADR-05: Выбор стратегии управления данными: База данных на сервис

### Статус

Принято

### Контекст

- Необходимо обеспечить независимое масштабирование сервисов.
- Необходимо использовать оптимальную СУБД для каждой задачи (например, реляционная база данных для профилей пользователей, NoSQL база данных для данных фитнес-трекеров).
- Необходимо избежать зависимости от одной централизованной базы данных.
- Требуется упростить внесение изменений в схему базы данных без влияния на другие сервисы.
- Рассматривалась альтернатива - общая база данных, но она была отклонена из-за проблем с масштабированием, зависимостями и сложностью внесения изменений.

### Решение

- Каждый микросервис имеет собственную базу данных (Database per Service).
- Выбор СУБД определяется потребностями каждого сервиса.
- Для обмена данными между сервисами использовать асинхронный обмен сообщениями (Kafka) или API запросы (с осторожностью).
- В случае необходимости выполнения транзакций, охватывающих несколько сервисов, использовать паттерн Saga.

### Последствия

(+) Независимость сервисов и выбор оптимальной СУБД.

(+) Изоляция сбоев.

(-) Сложность управления данными между сервисами (eventual consistency).

(-) Сложность выполнения транзакций, охватывающих несколько сервисов.
# UC-02 : Отслеживание тренировки

### Название сценария

Отслеживание тренировки

### Краткое описание

Пользователь начинает и отслеживает тренировку, записывая такие показатели, как время, расстояние и сожженные калории.

### Действующие лица

Пользователь, Пользователь

### Предварительные условия

Пользователь аутентифицирован в мобильном приложении.

### Постусловия

Данные тренировки сохраняются в истории пользователя.

### Основной поток

1. Пользователь выбирает тип тренировки (например, бег, плавание, силовая тренировка) в мобильном приложении.
2. Мобильное приложение отправляет запрос в Сервис тренировок (WorkoutService) на создание новой тренировки, передавая тип тренировки и ID пользователя.
3. Сервис тренировок создает запись о новой тренировке в Базе данных тренировок (WorkoutDB) и возвращает ID созданной тренировки мобильному приложению.
4. Мобильное приложение отображает экран тренировки с возможностью старта, паузы и завершения.
5. Пользователь нажимает кнопку "Старт" для начала тренировки. Мобильное приложение начинает локально отслеживать параметры тренировки, такие как время, расстояние и калории (рассчитанные на основе данных пользователя и выбранного типа тренировки).
6. Если подключен монитор сердечного ритма, он отправляет данные о частоте сердечных сокращений (ЧСС) в мобильное приложение.
7. Мобильное приложение отправляет данные о ЧСС и ID тренировки в Сервис тренировок.
8. Сервис тренировок обновляет данные о ЧСС для текущей тренировки в Базе данных тренировок.
9. Если тренировка проходит на открытом воздухе, мобильное приложение запрашивает данные GPS у Геолокационного сервиса (GeoService).
10. Геолокационный сервис обращается к внешнему сервису геолокации (например, Google Maps) и возвращает текущие координаты GPS мобильному приложению.
11. Мобильное приложение отправляет данные GPS и ID тренировки в Сервис тренировок.
12. Сохранение данных GPS: Сервис тренировок обновляет данные GPS для текущей тренировки в Базе данных тренировок.
13. Если это силовая тренировка, пользователь вводит количество повторений и вес для каждого подхода.
14. Мобильное приложение отправляет данные о повторениях, весе и ID тренировки в Сервис тренировок.
15. Сервис тренировок обновляет данные о повторениях и весе для текущей тренировки в Базе данных тренировок.
16. Шаги 6-15 повторяются до тех пор, пока тренировка не будет завершена или приостановлена.
17. Пользователь может приостановить тренировку. Мобильное приложение отправляет запрос в Сервис тренировок на приостановку тренировки с указанием ID тренировки. Сервис тренировок обновляет статус тренировки в Базе данных тренировок. При возобновлении тренировки выполняется аналогичный процесс для обновления статуса.
18. Пользователь нажимает кнопку "Завершить тренировку".
19. Мобильное приложение предлагает пользователю добавить заметки к тренировке (например, о самочувствии или особенностях тренировки).
20. Мобильное приложение отправляет данные о завершении тренировки, заметки (если есть) и ID тренировки в Сервис тренировок.
21. Сервис тренировок завершает тренировку и сохраняет заметки в Базе данных тренировок.
22. Мобильное приложение отображает пользователю результаты тренировки.

### Альтернативные потоки

1. Если во время тренировки на открытом воздухе потерян сигнал GPS, система предупреждает пользователя и продолжает отслеживать время и другие доступные показатели.
2. Если монитор сердечного ритма отключается, система предупреждает пользователя.
3. Если пользователь отменяет тренировку до ее завершения, система запрашивает подтверждение и отбрасывает данные.


